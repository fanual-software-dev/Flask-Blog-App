{% extends "base.html"%}
{% block title %} blogs {% endblock %}

{% block content %}
<style>
    .main-page-div{
        display: flex;
        width: 100%;
        padding: 20px;
        justify-content: space-between;
    }

    .main-page{
        width: 55%;
        display: grid;
        grid-template-columns: 50% 50%;
        gap: 10px;
    
    }

    .blogs{
    /* width: 100%; */
        height: auto;
        margin-bottom: 50px;
        border-radius: 10px;
        background-color: lightgray;

    }

    .blogs img{
        width: 100%;
        height: 200px;
        border-top-left-radius: 10px;
        border-top-right-radius: 10px;
    }

    .blogs div{
        padding-left: 10px;
    }

    .blogs p{
        color: rgb(2, 46, 68);
        font-family: monospace;
        text-align: center;
    }

    .title{
        font-size: 18px;
        text-align: center;
        font-weight: bold;
    }

    .blogs button {
        width: 25px;
        height: 25px;
        display: flex;
        align-items: center;
        justify-content: center;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        background-color: dodgerblue;
        border: 1px solid dodgerblue;
    }

    .blogs button img{
        height: 15px;
        height: 15px;
    }

    .likes-comments-div{
        width: 100%;
        display: flex;
        justify-content: start;
        align-items: center;
        gap: 10px;
    }

    .likes-comments{
        display: flex;
        justify-content: start;
        align-items: center;
        gap: 10px;
    }

    .likes-comments p{
        font-weight: bold;
        font-size: 16px;
        font-family: monospace;
    }

    .likes-comments-div span{
        cursor: pointer;
    }

    .time{
        width: 70%;
    }

    .form-div{
        width: 35%;
    }

    form{
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        border-radius: 5px;
        background-color: rgba(4, 65, 82, 0.889);
        box-shadow: 1px 5px 15px rgba(98, 105, 98, 0.937);
    }

    .input-div{
        display: flex;
        flex-direction: column;
        gap: 5px;
        padding-top: 20px;
        width: 90%;
        font-family: monospace;
        font-size: 16px;
        color: rgb(255, 255, 255);
        font-weight: bold;
        /* border: 2px solid black; */
    }

    .input-div input{
        height: 60px;
        border-radius: 5px;
        padding-left: 20px;
        font-family: monospace;
        border: 1px solid rgba(245, 222, 179, 0.258);
        width: 100%;
    }

    .input-div textarea{
        height: 170px;
        padding-top: 15px;
        padding-left: 20px;
        border: 1px solid rgba(245, 222, 179, 0.258);
        border-radius: 5px;
        width: 100%;
        margin-bottom: 30px;
    }

    .form-button{
        padding-left: 55px;
        padding-right: 55px;
        height: 45px;
        margin-bottom: 30px;
        border: none;
        background-color: rgb(255, 166, 0);
        color: white;
        font-weight: bold;
        font-size: 16px;
        border-radius: 5px;
        cursor: pointer;
    }

    .form-button:hover{
        background-color: rgb(0, 185, 117);
    }

</style>

<div class="main-body">
    <div class="main-page-div">
        <div class="main-page">

            {% for blog in blogs%}

                <div class='blogs'>
                    <img src="{{blog['image']}}" alt='image not found'/>
                    <div class='blog-cards'>
                    <p class='title'>{{blog.title}}</p>
                    <p class='main'>{{blog.main}}</p>
                    </div>
            
                    <div class='likes-comments-div'>
                    <div class='likes-comments'>
                        <button onClick={ADD_LIKE}><img src='https://cdn-icons-png.flaticon.com/128/2107/2107845.png' alt='image not found'/></button>
                        <p id='likes'>{{blog.numberOfLikes}}</p>
                    </div>
                    <p class='time'>{{blog.createdAt}}</p>
                    <span onClick={DELETE_BLOG} class='material-icons'>delete</span>
                    </div>
                </div>
            {% endfor %}

        </div>
    
        <div class='form-div'>
            <form onsubmit="create_blog()">
                <div class='input-div'>
                    <label for="title">Title</label>
                    <input type='text' id="title" name="title" placeholder='Type your story title' required/>
                </div>
    
                <div class='input-div'>
                    <label for="image">Image Url</label>
                    <input type='text' id="image" name="image" placeholder='Put image url' required/>
                </div>
    
                <div class='input-div'>
                    <label>Story</label>
                    <textarea name="main" id="main" placeholder="We wanna hear about your story. start writing..."></textarea>
                </div>
    
                <button type='submit' class='form-button'>Create Blog</button>
                <p id="message"></p>
            </form>
          
        </div>



    </div>

</div>

<script>

    async function create_blog(e){
        e.preventDefault()

        const title = document.getElementById('title').value
        const image = document.getElementById('image').value
        const main = document.getElementById('main').value
        const createdAt = Date.now()
        const numberOfLikes = 0

        const data = {title,image,main,numberOfLikes,createdAt}

        const res = await fetch('/createBlog',{
            method:'POST',
            body:JSON.stringify(data),
            headers:{
                'Content-Type':'application/json'
            }
        })

        const NewBlog = await res.json()

        if (res.ok){
            document.getElementById('message').innerHTML = 'Blog created successfully !'
            document.getElementById('title').value = ''
            document.getElementById('image').value = ''
            document.getElementById('main').value = ''


        }

        else{
            document.getElementById('message').innerHTML = 'Something went wrong while creating the blog. '

        }


    }

</script>
{% endblock %}